var zcmx = [
    {
        "BianHao": "ZCMX201910280001",
        "IsShowBZZ": "false",
        "JinE": "526.5",
        "MingCheng": "城市交通费",
        "IsOcr": "1",
        "FeiYongMX": [
            [
                {
                    "BianHao": "FYMX201911190015",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "name",
                    "FeiYongMXMC": "乘车人",
                    "FeiYongMXZ": "曹思培"
                },
                {
                    "BianHao": "FYMX201911190016",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "startStation",
                    "FeiYongMXMC": "出发站",
                    "FeiYongMXZ": "杭州东站"
                },
                {
                    "BianHao": "FYMX201911190017",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "arriveStation",
                    "FeiYongMXMC": "到达站",
                    "FeiYongMXZ": "南京南站"
                },
                {
                    "BianHao": "FYMX201911190018",
                    "Options": [],
                    "Type": "3",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "date",
                    "FeiYongMXMC": "出发日期",
                    "FeiYongMXZ": "2016-10-15"
                },
                {
                    "BianHao": "FYMX201911190019",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "seatCategory",
                    "FeiYongMXMC": "座位类型",
                    "FeiYongMXZ": "二等座"
                },
                {
                    "BianHao": "FYMX201911190020",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "ticketPrice",
                    "FeiYongMXMC": "票价",
                    "FeiYongMXZ": "117.5"
                },
                {
                    "BianHao": "FYMX201911190021",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "trainNum",
                    "FeiYongMXMC": "车次",
                    "FeiYongMXZ": "G7608"
                },
                {
                    "Type": -1,
                    "OcrCode": "FuJianXX",
                    "FeiYongMXMC": "附件",
                    "FeiYongMXZ": "http://119.18.195.153:8089/bpm/image//upload/FJ200106102100044.jpg",
                    "FuJianMC": "FJ200106102100044.jpg",
                    "FuJianKey": "94b484373a523f62899683f32efcac45"
                }
            ],
            [
                {
                    "BianHao": "FYMX201911190015",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "name",
                    "FeiYongMXMC": "乘车人",
                    "FeiYongMXZ": "官青"
                },
                {
                    "BianHao": "FYMX201911190016",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "startStation",
                    "FeiYongMXMC": "出发站",
                    "FeiYongMXZ": "衢州站"
                },
                {
                    "BianHao": "FYMX201911190017",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "arriveStation",
                    "FeiYongMXMC": "到达站",
                    "FeiYongMXZ": "祁东站"
                },
                {
                    "BianHao": "FYMX201911190018",
                    "Options": [],
                    "Type": "3",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "date",
                    "FeiYongMXMC": "出发日期",
                    "FeiYongMXZ": "2020-01-06"
                },
                {
                    "BianHao": "FYMX201911190019",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "seatCategory",
                    "FeiYongMXMC": "座位类型",
                    "FeiYongMXZ": "二等座"
                },
                {
                    "BianHao": "FYMX201911190020",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "ticketPrice",
                    "FeiYongMXMC": "票价",
                    "FeiYongMXZ": "409"
                },
                {
                    "BianHao": "FYMX201911190021",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "trainNum",
                    "FeiYongMXMC": "车次",
                    "FeiYongMXZ": "G2343"
                },
                {
                    "Type": -1,
                    "OcrCode": "FuJianXX",
                    "FeiYongMXMC": "附件",
                    "FeiYongMXZ": "",
                    "FuJianMC": "FJ200106102100044.jpg",
                    "FuJianKey": "94b484373a523f62899683f32efcac45"
                }
            ]
        ]
    },
    {
        "BianHao": "ZCMX201910280002",
        "IsShowBZZ": "false",
        "JinE": "2800",
        "MingCheng": "差旅费",
        "IsOcr": "2",
        "FeiYongMX": [
            [
                {
                    "BianHao": "FYMX201911190022",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "sellerId",
                    "FeiYongMXMC": "销售方纳税人识别号",
                    "FeiYongMXZ": "91110108723969982M"
                },
                {
                    "BianHao": "FYMX201911190023",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "sellerBank",
                    "FeiYongMXMC": "销售方开户行及账号",
                    "FeiYongMXZ": "中国工商银行股份有限公司北京海淀支行营业部020004961920005330B"
                },
                {
                    "BianHao": "FYMX201911190024",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "sellerName",
                    "FeiYongMXMC": "销售方名称",
                    "FeiYongMXZ": "北京中科三方网络技术有限公司"
                },
                {
                    "BianHao": "FYMX201911190025",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "buyerId",
                    "FeiYongMXMC": "购买方纳税人识别号",
                    "FeiYongMXZ": "91330100143054524X"
                },
                {
                    "BianHao": "FYMX201911190026",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "buyerName",
                    "FeiYongMXMC": "购买方名称",
                    "FeiYongMXZ": "杭州鸿雁电器有限公司"
                },
                {
                    "BianHao": "FYMX201911190027",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "del",
                    "FeiYongMXMC": "是否作废",
                    "FeiYongMXZ": "否"
                },
                {
                    "BianHao": "FYMX201911190028",
                    "Options": [],
                    "Type": "3",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "issueDate",
                    "FeiYongMXMC": "开票日期",
                    "FeiYongMXZ": "2019-07-24"
                },
                {
                    "BianHao": "FYMX201911190029",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "subtotalAmount",
                    "FeiYongMXMC": "合计金额",
                    "FeiYongMXZ": "2641.51"
                },
                {
                    "BianHao": "FYMX201911190030",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "subtotalTax",
                    "FeiYongMXMC": "合计税额",
                    "FeiYongMXZ": "158.49"
                },
                {
                    "BianHao": "FYMX201911190031",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "type",
                    "FeiYongMXMC": "发票类型",
                    "FeiYongMXZ": "专用发票"
                },
                {
                    "BianHao": "FYMX201911190032",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "checkCode",
                    "FeiYongMXMC": "发票校验码",
                    "FeiYongMXZ": "34010002"
                },
                {
                    "BianHao": "FYMX201911190033",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "number",
                    "FeiYongMXMC": "发票号",
                    "FeiYongMXZ": "02237701"
                },
                {
                    "BianHao": "FYMX201911190034",
                    "Options": [],
                    "Type": "2",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "code",
                    "FeiYongMXMC": "发票代码",
                    "FeiYongMXZ": "1100191130"
                },
                {
                    "BianHao": "FYMX201911190035",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "OcrCode": "total",
                    "FeiYongMXMC": "价税合计",
                    "FeiYongMXZ": "2800"
                },
                {
                    "Type": -1,
                    "OcrCode": "FuJianXX",
                    "FeiYongMXMC": "附件",
                    "FeiYongMXZ": "http://119.18.195.153:8089/bpm/image//upload/FJ200106102400003.jpg",
                    "FuJianMC": "FJ200106102400003.jpg",
                    "FuJianKey": "b2966f058c736f40897bf21e92d97ece"
                }
            ]
        ]
    },
    {
        "BianHao": "ZCMX201812240001",
        "IsShowBZZ": "true",
        "JinE": "180",
        "MingCheng": "工伤险",
        "FeiYongMX": [
            [
                {
                    "BianHao": "FYMX201912090016",
                    "Options": [
                        {
                            "Value": "FZXXZ201912060004",
                            "Text": "12"
                        },
                        {
                            "Value": "FZXXZ201912060005",
                            "Text": "121"
                        },
                        {
                            "Value": "FZXXZ201912060006",
                            "Text": "1212"
                        }
                    ],
                    "Type": 4,
                    "BiaoZhunFZXH": "1",
                    "FeiYongMXMC": "级别",
                    "FeiYongMXZ": "FZXXZ201912060004"
                },
                {
                    "BianHao": "FYMX201912090017",
                    "Options": [
                        {
                            "Value": "FZXXZ201912060001",
                            "Text": "1"
                        },
                        {
                            "Value": "FZXXZ201912060003",
                            "Text": "12"
                        }
                    ],
                    "Type": 4,
                    "BiaoZhunFZXH": "2",
                    "FeiYongMXMC": "差旅费",
                    "FeiYongMXZ": "FZXXZ201912060001"
                },
                {
                    "BianHao": "FYMX201912090018",
                    "Options": [
                        {
                            "Value": "FZXXZ201912060002",
                            "Text": "基本支出"
                        }
                    ],
                    "Type": 4,
                    "BiaoZhunFZXH": "3",
                    "FeiYongMXMC": "基本支出",
                    "FeiYongMXZ": "FZXXZ201912060002"
                },
                {
                    "BianHao": "FYMX201912090019",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "FeiYongMXMC": "a",
                    "FeiYongMXZ": "50"
                },
                {
                    "BianHao": "FYMX201912090020",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "FeiYongMXMC": "v",
                    "FeiYongMXZ": "60"
                },
                {
                    "Type": 0,
                    "FeiYongMXMC": "标准费用",
                    "FeiYongMXZ": "1"
                }
            ],
            [
                {
                    "BianHao": "FYMX201912090016",
                    "Options": [
                        {
                            "Value": "FZXXZ201912060004",
                            "Text": "12"
                        },
                        {
                            "Value": "FZXXZ201912060005",
                            "Text": "121"
                        },
                        {
                            "Value": "FZXXZ201912060006",
                            "Text": "1212"
                        }
                    ],
                    "Type": 4,
                    "BiaoZhunFZXH": "1",
                    "FeiYongMXMC": "级别",
                    "FeiYongMXZ": "FZXXZ201912060004"
                },
                {
                    "BianHao": "FYMX201912090017",
                    "Options": [
                        {
                            "Value": "FZXXZ201912060001",
                            "Text": "1"
                        },
                        {
                            "Value": "FZXXZ201912060003",
                            "Text": "12"
                        }
                    ],
                    "Type": 4,
                    "BiaoZhunFZXH": "2",
                    "FeiYongMXMC": "差旅费",
                    "FeiYongMXZ": "FZXXZ201912060001"
                },
                {
                    "BianHao": "FYMX201912090018",
                    "Options": [
                        {
                            "Value": "FZXXZ201912060002",
                            "Text": "基本支出"
                        }
                    ],
                    "Type": 4,
                    "BiaoZhunFZXH": "3",
                    "FeiYongMXMC": "基本支出",
                    "FeiYongMXZ": "FZXXZ201912060002"
                },
                {
                    "BianHao": "FYMX201912090019",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "FeiYongMXMC": "a",
                    "FeiYongMXZ": "40"
                },
                {
                    "BianHao": "FYMX201912090020",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "FeiYongMXMC": "v",
                    "FeiYongMXZ": "30"
                },
                {
                    "Type": 0,
                    "FeiYongMXMC": "标准费用",
                    "FeiYongMXZ": "1"
                }
            ]
        ]
    },
    {
        "BianHao": "ZCMX201812240002",
        "IsShowBZZ": "false",
        "JinE": "50",
        "MingCheng": "失业险",
        "FeiYongMX": []
    },
    {
        "BianHao": "ZCMX201812240003",
        "IsShowBZZ": "false",
        "JinE": "100",
        "MingCheng": "住房公积金",
        "FeiYongMX": [
            [
                {
                    "BianHao": "FYMX201912090003",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "FeiYongMXMC": "a",
                    "FeiYongMXZ": "30"
                },
                {
                    "BianHao": "FYMX201912090004",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "FeiYongMXMC": "b",
                    "FeiYongMXZ": "40"
                }
            ],
            [
                {
                    "BianHao": "FYMX201912090003",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "FeiYongMXMC": "a",
                    "FeiYongMXZ": "10"
                },
                {
                    "BianHao": "FYMX201912090004",
                    "Options": [],
                    "Type": "1",
                    "BiaoZhunFZXH": "",
                    "FeiYongMXMC": "b",
                    "FeiYongMXZ": "20"
                }
            ]
        ]
    }
]
var fjxx = []; //附件信息
_ZhiChuXX = [];
_.forEach(zcmx, function(v, k){
    //附件信息
    if (v.IsOcr) {
        _.forEach(v.FeiYongMX, function (q, p) {
            _.forEach(q, function(x, y) {
                if (x.Type == -1 && x.FeiYongMXZ) {
                    fjxx.push({
                        FuJianMC: x.FuJianMC,
                        FuJianLJ: x.FeiYongMXZ
                    })
                }
            })
        })
    }
    var c = _.flatMapDepth(v.FeiYongMX, function (v) {
        return v;
    }, 1);
    var _FeiYongMX = []; //费用明细
    var _BiaoZhuFY = 0; //标准费用
    _.forEach(_.groupBy(c, 'BianHao'), function (x, y) {
        if (y != 'undefined' ) {
            _FeiYongMX.push({
                'MingXiBH': y,
                'MingXiZ': _.map(x, 'FeiYongMXZ')
            })
        } else {
           _.forEach(_.map(x, function (v) {
               if (v.Type == 0) {
                   return v.FeiYongMXZ
               } else {
                   return 0
               }
           }), function (v) {
               _BiaoZhuFY += _.toNumber(v)
           });
        }
    });
    _ZhiChuXX.push({
        ZhiChuMXBH: v.BianHao,
        JinE: v.JinE,
        BiaoZhuFY: _BiaoZhuFY,
        FeiYongMX: _FeiYongMX
    })
})
console.log('zcmx>' + JSON.stringify(_ZhiChuXX))
